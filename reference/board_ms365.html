<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Use a OneDrive or Sharepoint document library as a board — board_ms365 • pins</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Use a OneDrive or Sharepoint document library as a board — board_ms365"><meta name="description" content="Pin data to a folder in Onedrive or a SharePoint Online document library
using the Microsoft365R package."><meta property="og:description" content="Pin data to a folder in Onedrive or a SharePoint Online document library
using the Microsoft365R package."><meta property="og:image" content="https://pins.rstudio.com/logo.png"><!-- Google Tag Manager --><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-KHBDBW7');</script><!-- End Google Tag Manager --></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>
    <!-- Google Tag Manager (noscript) -->
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KHBDBW7" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<!-- End Google Tag Manager (noscript) -->


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pins</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.4.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/pins.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/customize-pins-metadata.html">Create consistent metadata for pins</a></li>
    <li><a class="dropdown-item" href="../articles/managing-custom-formats.html">Managing custom formats</a></li>
    <li><a class="dropdown-item" href="../articles/pins-update.html">Upgrading to pins 1.0.0</a></li>
    <li><a class="dropdown-item" href="../articles/posit-connect.html">Posit Connect</a></li>
    <li><a class="dropdown-item" href="../articles/using-board-url.html">Using web-hosted boards</a></li>
  </ul></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-news" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">News</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-news"><li><h6 class="dropdown-header" data-toc-skip>Releases</h6></li>
    <li><a class="external-link dropdown-item" href="https://posit.co/blog/announcing-pins-1-1-0/">pins 1.1.0</a></li>
    <li><a class="external-link dropdown-item" href="https://blog.rstudio.com/2021/10/04/pins-1-0-0/">pins 1.0.0</a></li>
    <li><a class="external-link dropdown-item" href="https://blog.rstudio.com/2020/05/29/pins-0-4-0-versioning/">pins 0.4.0</a></li>
    <li><a class="external-link dropdown-item" href="https://blog.rstudio.com/2019/11/28/pins-0-3-0-azure-gcloud-and-s3/">pins 0.3.0</a></li>
    <li><a class="external-link dropdown-item" href="https://blog.rstudio.com/2019/09/09/pin-discover-and-share-resources/">pins 0.2.0</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../news/index.html">Changelog</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/rstudio/pins-r/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Use a OneDrive or Sharepoint document library as a board</h1>
      <small class="dont-index">Source: <a href="https://github.com/rstudio/pins-r/blob/v1.4.1/R/board_ms365.R" class="external-link"><code>R/board_ms365.R</code></a></small>
      <div class="d-none name"><code>board_ms365.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Pin data to a folder in Onedrive or a SharePoint Online document library
using the Microsoft365R package.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">board_ms365</span><span class="op">(</span></span>
<span>  <span class="va">drive</span>,</span>
<span>  <span class="va">path</span>,</span>
<span>  versioned <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  cache <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  delete_by_item <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-drive">drive<a class="anchor" aria-label="anchor" href="#arg-drive"></a></dt>
<dd><p>A OneDrive or SharePoint document library object, of class
<code><a href="https://rdrr.io/pkg/Microsoft365R/man/ms_drive.html" class="external-link">Microsoft365R::ms_drive</a></code>.</p></dd>


<dt id="arg-path">path<a class="anchor" aria-label="anchor" href="#arg-path"></a></dt>
<dd><p>Path to directory to store pins. This can be either a string
containing the pathname like <code>"path/to/board"</code>, or a
<code><a href="https://rdrr.io/pkg/Microsoft365R/man/ms_drive_item.html" class="external-link">Microsoft365R::ms_drive_item</a></code> object pointing to the board path.</p></dd>


<dt id="arg-versioned">versioned<a class="anchor" aria-label="anchor" href="#arg-versioned"></a></dt>
<dd><p>Should this board be registered with support for versions?</p></dd>


<dt id="arg-cache">cache<a class="anchor" aria-label="anchor" href="#arg-cache"></a></dt>
<dd><p>Cache path. Every board requires a local cache to avoid
downloading files multiple times. The default stores in a standard
cache location for your operating system, but you can override if needed.</p></dd>


<dt id="arg-delete-by-item">delete_by_item<a class="anchor" aria-label="anchor" href="#arg-delete-by-item"></a></dt>
<dd><p>Whether to handle folder deletions on an item-by-item
basis, rather than deleting the entire folder at once. You may need to set
this to <code>TRUE</code> for a board in SharePoint Online or OneDrive for Business,
due to document protection policies that prohibit deleting non-empty
folders.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Sharing a board in OneDrive (personal or business) is a bit complicated, as
OneDrive normally allows only the person who owns the drive to access files
and folders. First, the drive owner has to set the board folder as shared
with other users, using either the OneDrive web interface or Microsoft365R's
<code>ms_drive_item$create_share_link()</code> method. The other users then call
<code>board_ms365</code> with a <em>drive item object</em> in the <code>path</code> argument, pointing to
the shared folder. See the examples below.</p>
<p>Sharing a board in SharePoint Online is much more straightforward, assuming
all users have access to the document library: in this case, everyone can
use the same call <code>board_ms365(doclib, "path/to/board")</code>. If you want to
share a board with users outside your team, follow the same steps for sharing
a board in OneDrive.</p>
<p><code>board_ms365()</code> is powered by the Microsoft365R package, which is a suggested
dependency of pins (not required for pins in general). If you run into errors
when deploying content to a server like <a href="https://www.shinyapps.io" class="external-link">https://www.shinyapps.io</a> or
<a href="https://posit.co/products/enterprise/connect/" class="external-link">Connect</a>, add
<code><a href="https://github.com/Azure/Microsoft365R" class="external-link">requireNamespace("Microsoft365R")</a></code> to your app or document for <a href="https://docs.posit.co/connect/user/troubleshooting/#render-missing-r-package" class="external-link">automatic dependency discovery</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># A board in your personal OneDrive</span></span></span>
<span class="r-in"><span><span class="va">od</span> <span class="op">&lt;-</span> <span class="fu">Microsoft365R</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Microsoft365R/man/client.html" class="external-link">get_personal_onedrive</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">board</span> <span class="op">&lt;-</span> <span class="fu">board_ms365</span><span class="op">(</span><span class="va">od</span>, <span class="st">"myboard"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">board</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="pin_read.html">pin_write</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># A board in OneDrive for Business</span></span></span>
<span class="r-in"><span><span class="va">odb</span> <span class="op">&lt;-</span> <span class="fu">Microsoft365R</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Microsoft365R/man/client.html" class="external-link">get_business_onedrive</a></span><span class="op">(</span>tenant <span class="op">=</span> <span class="st">"mytenant"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">board</span> <span class="op">&lt;-</span> <span class="fu">board_ms365</span><span class="op">(</span><span class="va">odb</span>, <span class="st">"myproject/board"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># A board in a SharePoint Online document library</span></span></span>
<span class="r-in"><span><span class="va">sp</span> <span class="op">&lt;-</span> <span class="fu">Microsoft365R</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/Microsoft365R/man/client.html" class="external-link">get_sharepoint_site</a></span><span class="op">(</span><span class="st">"my site"</span>, tenant <span class="op">=</span> <span class="st">"mytenant"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">doclib</span> <span class="op">&lt;-</span> <span class="va">sp</span><span class="op">$</span><span class="fu">get_drive</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">board</span> <span class="op">&lt;-</span> <span class="fu">board_ms365</span><span class="op">(</span><span class="va">doclib</span>, <span class="st">"general/project1/board"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Sharing a board in OneDrive:</span></span></span>
<span class="r-in"><span><span class="co"># First, create the board on the drive owner's side</span></span></span>
<span class="r-in"><span><span class="va">board</span> <span class="op">&lt;-</span> <span class="fu">board_ms365</span><span class="op">(</span><span class="va">od</span>, <span class="st">"myboard"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Next, let other users write to the folder</span></span></span>
<span class="r-in"><span><span class="co"># - set the expiry to NULL if you want the folder to be permanently available</span></span></span>
<span class="r-in"><span><span class="va">od</span><span class="op">$</span><span class="fu">get_item</span><span class="op">(</span><span class="st">"myboard"</span><span class="op">)</span><span class="op">$</span><span class="fu">create_share_link</span><span class="op">(</span><span class="st">"edit"</span>, expiry<span class="op">=</span><span class="st">"30 days"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># On the recipient's side: find the shared folder item, then pass it to board_ms365</span></span></span>
<span class="r-in"><span><span class="va">shared_items</span> <span class="op">&lt;-</span> <span class="va">od</span><span class="op">$</span><span class="fu">list_shared_items</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">board_folder</span> <span class="op">&lt;-</span> <span class="va">shared_items</span><span class="op">$</span><span class="va">remoteItem</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">shared_items</span><span class="op">$</span><span class="va">name</span> <span class="op">==</span> <span class="st">"myboard"</span><span class="op">)</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">board</span> <span class="op">&lt;-</span> <span class="fu">board_ms365</span><span class="op">(</span><span class="va">od</span>, <span class="va">board_folder</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://juliasilge.com/" class="external-link">Julia Silge</a>, <a href="https://hadley.nz" class="external-link">Hadley Wickham</a>, Javier Luraschi, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

  </div></footer></body></html>

